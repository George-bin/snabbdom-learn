<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Snabbdom学习</title>
  </head>
  <body>
    <div id="app">
      <button id="update-btn">update</button>
    </div>
    <script type="module">
      import { init, h } from './es/snabbdom.js';
      import datasetModule from './es/modules/dataset.js';
      import attributesModule from './es/modules/attributes.js';
      import classModule from './es/modules/class.js';
      import propsModule from './es/modules/props.js';
      import styleModule from './es/modules/style.js';
      import eventListenersModule from './es/modules/eventlisteners.js';
      /**
       * patch补丁函数：
       * 1、加载dom操作核心模块：class、props、style、eventlisteners => 各个模块中定义了对应属性的生命周期函数；
       * 2、定义了程序运行期间的所有钩子，每个钩子对应所有模块中对应的生命周期函数；
       * 3、在patch函数的各个阶段调用对应的钩子 => 即：所有模块中的对应生命周期函数。
       */
      var patch = init([
        datasetModule,
        attributesModule,
        classModule,
        propsModule,
        styleModule,
        eventListenersModule,
      ]);

      // 获取页面原始的DOM节点
      var app = document.getElementById("app");
      // 构造一个虚拟dom => 通过h函数建立虚拟dom的 => 生成vnode
      var vnode = h(
        "div#app",
        {},
        [
          h(
            'h1',
            {
              on: {
                // click: [[fun1], [fun2]]
                click: [fun1, 'Hello']
              }
            },
            'George'
          )
        ]
      );
      function fun1(value, e, vnode) {
        console.log('fun1')
        console.log(value, e, vnode)
      }
      function fun2(e, vnode) {
        console.log('fun2')
        console.log(e, vnode)
      }
      console.log(vnode)
      // 第一次渲染，使用vnode替换app节点的内容
      vnode = patch(app, vnode);

      // 创建一个新的vnode
      // var newVnode = h('div#app1',
      //   {style: {color: 'red'}},
      //   [
      //     h(
      //       'h1', 
      //       {},
      //       'My name is GaoShaSha'
      //     )
      //   ]
      // );
      // let updateBtn = document.getElementById('update-btn');
      // updateBtn.addEventListener('click', updateVnode)
      // function updateVnode() {
      //   patch(vnode, newVnode);
      // }
    </script>
  </body>
</html>
